<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard - Inclusive Learning Hub</title>

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <!-- Custom Styles -->
  <link rel="stylesheet" href="/css/adminStyle.css">
  <style>
    /* Ensure charts have a proper height */
    .charts-section canvas {
      width: 100% !important;
      max-width: 500px;
      height: 300px !important;   /* fixed height */
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    
    <!-- Sidebar include -->
    <%- include("../partials/adminSidebar") %>

    <!-- Main Content -->
    <main class="main-content">
      
      <!-- Top Bar -->
      <div class="top-bar">
        <div class="welcome-text">Welcome back, Admin!</div>
        <div class="user-profile">
          <div class="profile-pic">A</div>
          <span>Admin User</span>
        </div>
      </div>

      <div class="content-area">
        
        <!-- Quick Actions -->
        <section class="quick-actions">
          <a href="#" class="action-btn"><i class="fas fa-upload"></i> Upload Resource</a>
          <a href="/admin/addUser" class="action-btn"><i class="fas fa-user-plus"></i> Add User</a>
          <a href="/admin/listEducators" class="action-btn"><i class="fas fa-tags"></i> View Users</a>
        </section>

        <!-- Stats Cards -->
        <section class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-chalkboard-teacher"></i></div>
            <div class="stat-number">247</div>
            <div class="stat-label">Special Educators</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-folder-open"></i></div>
            <div class="stat-number">1,856</div>
            <div class="stat-label">Learning Resources</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-magic"></i></div>
            <div class="stat-number">432</div>
            <div class="stat-label">AI Generated Content</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-share-alt"></i></div>
            <div class="stat-number">89%</div>
            <div class="stat-label">Public Sharing Rate</div>
          </div>
        </section>

        <!-- Charts Section -->
        <section class="charts-section">
          <div class="chart-card">
            <div class="chart-title">Resource Usage by Disability Type</div>
            <canvas id="engagementChart" width="500" height="300"></canvas> <!--  fixed attributes -->
          </div>
          <div class="chart-card">
            <div class="chart-title">Content Type Distribution</div>
            <canvas id="contentChart" width="500" height="300"></canvas> <!--  fixed attributes -->
          </div>
        </section>

        <!-- Recent Activity -->
        <section class="activity-section">
          <div class="chart-title">Recent Platform Activity</div>

          <div class="activity-item">
            <div class="activity-icon"><i class="fas fa-magic" style="color:#7fb069;"></i></div>
            <div class="activity-content">
              <div class="activity-text">AI generated new dyslexia-friendly worksheet for Grade 3 Math</div>
              <div class="activity-time">5 minutes ago</div>
            </div>
          </div>

          <div class="activity-item">
            <div class="activity-icon"><i class="fas fa-share-alt" style="color:#d73527;"></i></div>
            <div class="activity-content">
              <div class="activity-text">Educator Sarah M. shared ADHD attention exercises publicly</div>
              <div class="activity-time">18 minutes ago</div>
            </div>
          </div>

          <div class="activity-item">
            <div class="activity-icon"><i class="fas fa-puzzle-piece" style="color:#4a5568;"></i></div>
            <div class="activity-content">
              <div class="activity-text">New brain development puzzle added to Autism support category</div>
              <div class="activity-time">45 minutes ago</div>
            </div>
          </div>

          <div class="activity-item">
            <div class="activity-icon"><i class="fas fa-video" style="color:#718096;"></i></div>
            <div class="activity-content">
              <div class="activity-text">Uploaded sign language video for hearing impaired students</div>
              <div class="activity-time">2 hours ago</div>
            </div>
          </div>

          <div class="activity-item">
            <div class="activity-icon"><i class="fas fa-users" style="color:#7fb069;"></i></div>
            <div class="activity-content">
              <div class="activity-text">Community discussion: "Best practices for visual learning aids"</div>
              <div class="activity-time">3 hours ago</div>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- Accessibility Indicator -->
  <div class="accessibility-indicator" title="Accessibility Tools">
    <i class="fas fa-universal-access"></i>
  </div>

  <!-- Inline Chart Scripts -->
  <script>
    function resizeCanvas(canvas) {
      // Only resize if canvas has height
      if (!canvas.clientWidth || !canvas.clientHeight) return;
      canvas.width = canvas.clientWidth * window.devicePixelRatio;
      canvas.height = canvas.clientHeight * window.devicePixelRatio;
    }

    function createEngagementChart() {
      const canvas = document.getElementById('engagementChart');
      resizeCanvas(canvas);
      const ctx = canvas.getContext('2d');

      const data = [32, 28, 25, 18, 15, 12, 8];
      const labels = ['Dyslexia', 'ADHD', 'Autism', 'Visual', 'Hearing', 'Motor', 'Other'];
      const colors = ['#d73527', '#7fb069', '#4a5568', '#718096', '#e53e3e', '#38b2ac', '#805ad5'];

      const chartWidth = canvas.width - 80;
      const chartHeight = canvas.height - 80;
      const startX = 40;
      const startY = 40;
      const barWidth = chartWidth / labels.length - 10;
      const maxValue = Math.max(...data);

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      data.forEach((value, index) => {
        const barHeight = (value / maxValue) * (chartHeight - 40);
        const x = startX + index * (barWidth + 10);
        const y = startY + chartHeight - barHeight - 20;

        ctx.fillStyle = colors[index];
        ctx.fillRect(x, y, barWidth, barHeight);

        ctx.fillStyle = '#333';
        ctx.font = '14px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(value + '%', x + barWidth / 2, y - 5);

        ctx.save();
        ctx.translate(x + barWidth / 2, startY + chartHeight - 5);
        ctx.rotate(-Math.PI / 4);
        ctx.textAlign = 'right';
        ctx.fillText(labels[index], 0, 0);
        ctx.restore();
      });
    }

    function createContentChart() {
      const canvas = document.getElementById('contentChart');
      resizeCanvas(canvas);
      const ctx = canvas.getContext('2d');

      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = Math.min(canvas.width, canvas.height) / 3;

      const data = [
        { label: 'Videos', value: 30, color: '#d73527' },
        { label: 'Worksheets', value: 25, color: '#7fb069' },
        { label: 'Flashcards', value: 20, color: '#4a5568' },
        { label: 'Stories', value: 15, color: '#718096' },
        { label: 'Games', value: 10, color: '#e53e3e' }
      ];

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      let currentAngle = 0;
      data.forEach(segment => {
        const sliceAngle = (segment.value / 100) * 2 * Math.PI;

        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
        ctx.closePath();
        ctx.fillStyle = segment.color;
        ctx.fill();

        const labelAngle = currentAngle + sliceAngle / 2;
        const labelX = centerX + Math.cos(labelAngle) * (radius + 30);
        const labelY = centerY + Math.sin(labelAngle) * (radius + 30);

        ctx.fillStyle = '#333';
        ctx.font = '13px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(segment.label, labelX, labelY);
        ctx.fillText(segment.value + '%', labelX, labelY + 14);

        currentAngle += sliceAngle;
      });
    }

    function drawCharts() {
      createEngagementChart();
      createContentChart();
    }

    window.addEventListener('load', drawCharts);
    window.addEventListener('resize', drawCharts);
  </script>

  
</body>
</html>
